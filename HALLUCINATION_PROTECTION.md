# üõ°Ô∏è –ó–∞—â–∏—Ç–∞ –æ—Ç –≥–∞–ª–ª—é—Ü–∏–Ω–∞—Ü–∏–π –≤ SMART RAG Agent

## –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç 2025-10-16

–ü–æ–ª–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –≥–∞–ª–ª—é—Ü–∏–Ω–∞—Ü–∏–π –∏ –≤—ã–¥—É–º—ã–≤–∞–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.

---

## üéØ –ü—Ä–æ–±–ª–µ–º–∞, –∫–æ—Ç–æ—Ä—É—é —Ä–µ—à–∞–µ–º

### –ü—Ä–∏–º–µ—Ä –î–û —É–ª—É—á—à–µ–Ω–∏–π:

**–ó–∞–ø—Ä–æ—Å:** "–ø–æ–¥–±–µ—Ä–∏ –Ω–æ–≤–æ–≥–æ–¥–Ω–∏–µ –ø—Ä–∞–≤–æ—Å–ª–∞–≤–Ω—ã–µ –æ–±—Ä—è–¥—ã –Ω–∞ —Ä–æ–∂–¥–µ—Å—Ç–≤–æ"

**–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:** –≠–∑–æ—Ç–µ—Ä–∏–∫–∞ –∏ –∫–æ—Å–º–æ—ç–Ω–µ—Ä–≥–µ—Ç–∏–∫–∞ (–ù–ï–¢ –ø—Ä–∞–≤–æ—Å–ª–∞–≤–Ω—ã—Ö –ø—Ä–∞–∫—Ç–∏–∫)

**–û—Ç–≤–µ—Ç –º–æ–¥–µ–ª–∏ (–î–û):** ‚ùå
```
–ù–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø–æ –ø—Ä–∞–≤–æ—Å–ª–∞–≤–Ω—ã–º –æ–±—Ä—è–¥–∞–º:

1. –ü–æ—Å–µ—â–µ–Ω–∏–µ –†–æ–∂–¥–µ—Å—Ç–≤–µ–Ω—Å–∫–æ–π –Ω–æ—á–∏ (12-13 —è–Ω–≤–∞—Ä—è)
   - –í–µ—á–µ—Ä–Ω—è —Å –ë–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–π –õ–∏—Ç—É—Ä–≥–∏–µ–π
   - –ü–æ–∫–ª–æ–Ω–µ–Ω–∏–µ –≤–æ–ª—Ö–≤–∞–º...

2. –°–≤—è—Ç–æ–π –≤–µ—á–µ—Ä (12 —è–Ω–≤–∞—Ä—è / 25 –¥–µ–∫–∞–±—Ä—è)
   - –í–µ–ª–∏–∫–∏–π –ø–æ—Å—Ç –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è...
   - –ö—É—Ç—å—è ‚Äî —Å–∏–º–≤–æ–ª –•—Ä–∏—Å—Ç–∞...
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –ú–æ–¥–µ–ª—å –í–´–î–£–ú–ê–õ–ê –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é! –í –±–∞–∑–µ —ç—Ç–æ–≥–æ –ù–ï–¢!

---

## ‚úÖ –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

### 1. –ü–µ—Ä–µ–ø–∏—Å–∞–Ω —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç —Å —á–µ—Ç–∫–∏–º —É–∫–∞–∑–∞–Ω–∏–µ–º —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—è –±–∞–∑—ã

**–ë—ã–ª–æ:**
```python
system_prompt = """–¢—ã - —ç–∫—Å–ø–µ—Ä—Ç–Ω—ã–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –ø–æ –∫–æ—Å–º–æ—ç–Ω–µ—Ä–≥–µ—Ç–∏–∫–µ..."""
```

**–°—Ç–∞–ª–æ:**
```python
system_prompt = """–¢—ã - –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç —Ä–∞–±–æ—Ç–∞—é—â–∏–π —Å –±–∞–∑–æ–π –∑–Ω–∞–Ω–∏–π –ø–æ –≠–ó–û–¢–ï–†–ò–ö–ï –ò –ö–û–°–ú–û–≠–ù–ï–†–ì–ï–¢–ò–ö–ï.

‚ö†Ô∏è –°–û–î–ï–†–ñ–ê–ù–ò–ï –ë–ê–ó–´ –î–ê–ù–ù–´–•:
- –ö–æ—Å–º–æ—ç–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∏–µ –∫–∞–Ω–∞–ª—ã (–§–∏—Ä–∞—Å—Ç, –ó–µ–≤—Å, –ê–Ω–∞–∫–æ–Ω–¥–∞, –®–∞–æ–Ω –∏ –¥—Ä.)
- –≠–∑–æ—Ç–µ—Ä–∏—á–µ—Å–∫–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –∏ –æ–±—Ä—è–¥—ã
- –ú–∞–≥–∏—á–µ—Å–∫–∏–µ —Ä–∏—Ç—É–∞–ª—ã –∏ –∑–∞–≥–æ–≤–æ—Ä—ã
- –†–∞–±–æ—Ç–∞ —Å —ç–Ω–µ—Ä–≥–∏—è–º–∏
- –ù–ï–¢ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∫–∞–Ω–æ–Ω–∏—á–µ—Å–∫–∏—Ö —Ä–µ–ª–∏–≥–∏–æ–∑–Ω—ã—Ö –ø—Ä–∞–∫—Ç–∏–∫–∞—Ö!

üö´ –ê–ë–°–û–õ–Æ–¢–ù–´–ï –ó–ê–ü–†–ï–¢–´:
1. –ù–ï –ü–†–ò–î–£–ú–´–í–ê–ô –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é! –ò—Å–ø–æ–ª—å–∑—É–π –¢–û–õ–¨–ö–û –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã!
2. –ù–ï –î–û–î–£–ú–´–í–ê–ô –¥–µ—Ç–∞–ª–∏ –∏–∑ —Å–≤–æ–∏—Ö –æ–±—â–∏—Ö –∑–Ω–∞–Ω–∏–π!
3. –ù–ï –ò–ù–¢–ï–†–ü–†–ï–¢–ò–†–£–ô —ç–∑–æ—Ç–µ—Ä–∏–∫—É –∫–∞–∫ —Ä–µ–ª–∏–≥–∏–æ–∑–Ω—ã–µ –ø—Ä–∞–∫—Ç–∏–∫–∏!
4. –ï—Å–ª–∏ –≤–æ–ø—Ä–æ—Å –ù–ï –ø–æ —Ç–µ–º–µ –±–∞–∑—ã - —Ç–∞–∫ –∏ —Å–∫–∞–∂–∏!
```

### 2. –î–æ–±–∞–≤–ª–µ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Ç–µ–º—ã

–ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è `_check_topic_relevance()`:

```python
def _check_topic_relevance(self, query: str, documents: list) -> str:
    """–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Ç–µ–º—ã –∑–∞–ø—Ä–æ—Å–∞ –∏ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤"""

    # –ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ —Ä–∞–∑–Ω—ã—Ö —Ç–µ–º
    religious_keywords = ['–ø—Ä–∞–≤–æ—Å–ª–∞–≤', '—Ü–µ—Ä–∫–æ–≤', '–±–æ–≥–æ—Å–ª—É–∂', '–∫–∞–Ω–æ–Ω', ...]
    esoteric_keywords = ['–∫–æ—Å–º–æ—ç–Ω–µ—Ä–≥–µ—Ç', '–∫–∞–Ω–∞–ª', '—á–∞—Å—Ç–æ—Ç', '—ç–Ω–µ—Ä–≥–∏', ...]

    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–ø—Ä–æ—Å –∏ –¥–æ–∫—É–º–µ–Ω—Ç—ã
    is_religious_query = any(kw in query_lower for kw in religious_keywords)
    has_esoteric_content = any(kw in doc_text for kw in esoteric_keywords)

    # –§–æ—Ä–º–∏—Ä—É–µ–º –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
    if is_religious_query and has_esoteric_content:
        return "‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï: –í–æ–ø—Ä–æ—Å –ø—Ä–æ —Ä–µ–ª–∏–≥–∏–æ–∑–Ω—ã–µ –ø—Ä–∞–∫—Ç–∏–∫–∏, –Ω–æ –Ω–∞–π–¥–µ–Ω—ã –≠–ó–û–¢–ï–†–ò–ß–ï–°–ö–ò–ï –º–∞—Ç–µ—Ä–∏–∞–ª—ã!"
```

**–¢–µ–ø–µ—Ä—å —Å–∏—Å—Ç–µ–º–∞:**
- –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å
- –°—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç —Å —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ–º –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- –í—ã–¥–∞–µ—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –µ—Å–ª–∏ —Ç–µ–º—ã –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç

### 3. –£–ª—É—á—à–µ–Ω HTML-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å –∞–≤—Ç–æ–ø—Ä–æ–∫—Ä—É—Ç–∫–æ–π

**–î–æ–±–∞–≤–ª–µ–Ω–æ:**
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫ –Ω–æ–≤–æ–º—É –æ—Ç–≤–µ—Ç—É
- ‚úÖ –í–∏–∑—É–∞–ª—å–Ω—ã–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –≤ –æ—Ä–∞–Ω–∂–µ–≤—ã—Ö –±–ª–æ–∫–∞—Ö
- ‚úÖ –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
- ‚úÖ –ü–æ–∫–∞–∑ –ø–µ—Ä–≤—ã—Ö 5 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –ø–æ–¥ –æ—Ç–≤–µ—Ç–æ–º

```html
<div class='warning-box'>
    <b>‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï:</b><br>
    –í–æ–ø—Ä–æ—Å –ø—Ä–æ —Ä–µ–ª–∏–≥–∏–æ–∑–Ω—ã–µ –ø—Ä–∞–∫—Ç–∏–∫–∏, –Ω–æ –Ω–∞–π–¥–µ–Ω—ã –≠–ó–û–¢–ï–†–ò–ß–ï–°–ö–ò–ï –º–∞—Ç–µ—Ä–∏–∞–ª—ã!
</div>
```

### 4. –ü–æ–∫–∞–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤

–í –∫–∞–∂–¥–æ–º –æ—Ç–≤–µ—Ç–µ —Ç–µ–ø–µ—Ä—å –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è:

```
üìö –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏:

[–ò—Å—Ç–æ—á–Ω–∏–∫ 1]
–û–±—Ä—è–¥ —Å –†–æ–∂–¥–µ—Å—Ç–≤–µ–Ω—Å–∫–∏–º –≤–µ–Ω–∫–æ–º...

[–ò—Å—Ç–æ—á–Ω–∏–∫ 2]
–ú–æ–ª–∏—Ç–≤–µ–Ω–Ω—ã–π —â–∏—Ç ¬´–†–æ–∂–¥–µ—Å—Ç–≤–µ–Ω—Å–∫–∏–π¬ª...
```

–≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –≤–∏–¥–µ—Ç—å –æ—Ç–∫—É–¥–∞ –≤–∑—è—Ç–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è.

---

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –¢–æ—Ç –∂–µ –∑–∞–ø—Ä–æ—Å –ü–û–°–õ–ï —É–ª—É—á—à–µ–Ω–∏–π:

**–ó–∞–ø—Ä–æ—Å:** "–ø–æ–¥–±–µ—Ä–∏ –Ω–æ–≤–æ–≥–æ–¥–Ω–∏–µ –ø—Ä–∞–≤–æ—Å–ª–∞–≤–Ω—ã–µ –æ–±—Ä—è–¥—ã –Ω–∞ —Ä–æ–∂–¥–µ—Å—Ç–≤–æ"

**–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç (–ü–û–°–õ–ï):** ‚úÖ
```
‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï: –í–æ–ø—Ä–æ—Å –ø—Ä–æ —Ä–µ–ª–∏–≥–∏–æ–∑–Ω—ã–µ –ø—Ä–∞–∫—Ç–∏–∫–∏, –Ω–æ –Ω–∞–π–¥–µ–Ω—ã –≠–ó–û–¢–ï–†–ò–ß–ï–°–ö–ò–ï –º–∞—Ç–µ—Ä–∏–∞–ª—ã!

–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –≤ –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± —ç–∑–æ—Ç–µ—Ä–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∞–∫—Ç–∏–∫–∞—Ö
–∏ –∫–æ—Å–º–æ—ç–Ω–µ—Ä–≥–µ—Ç–∏–∫–µ. –ö–∞–Ω–æ–Ω–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∞–≤–æ—Å–ª–∞–≤–Ω—ã—Ö –æ–±—Ä—è–¥–æ–≤ –≤ –±–∞–∑–µ –ù–ï–¢.

–û–¥–Ω–∞–∫–æ —è –Ω–∞—à–µ–ª –Ω–µ—Å–∫–æ–ª—å–∫–æ –≠–ó–û–¢–ï–†–ò–ß–ï–°–ö–ò–• –æ–±—Ä—è–¥–æ–≤, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å –†–æ–∂–¥–µ—Å—Ç–≤–æ–º:

1. **–û–±—Ä—è–¥ —Å –†–æ–∂–¥–µ—Å—Ç–≤–µ–Ω—Å–∫–∏–º –≤–µ–Ω–∫–æ–º** (3-6 —è–Ω–≤–∞—Ä—è)
   - –≠—Ç–æ –≠–ó–û–¢–ï–†–ò–ß–ï–°–ö–ê–Ø –ø—Ä–∞–∫—Ç–∏–∫–∞, –Ω–µ –∫–∞–Ω–æ–Ω–∏—á–µ—Å–∫–∞—è –ø—Ä–∞–≤–æ—Å–ª–∞–≤–Ω–∞—è
   - –ò–∑–≥–æ—Ç–æ–≤–ª–µ–Ω–∏–µ –≤–µ–Ω–∫–∞ —Å 5 —Å–≤–µ—á–∞–º–∏
   - [–¥–µ—Ç–∞–ª–∏ –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞]

2. **–ú–æ–ª–∏—Ç–≤–µ–Ω–Ω—ã–π —â–∏—Ç ¬´–†–æ–∂–¥–µ—Å—Ç–≤–µ–Ω—Å–∫–∏–π¬ª** (25 –¥–µ–∫–∞–±—Ä—è / 7 —è–Ω–≤–∞—Ä—è)
   - –≠—Ç–æ –≠–ó–û–¢–ï–†–ò–ß–ï–°–ö–ê–Ø –ø—Ä–∞–∫—Ç–∏–∫–∞
   - –î—É—Ö–æ–≤–Ω–∞—è –∑–∞—â–∏—Ç–∞
   - [–¥–µ—Ç–∞–ª–∏ –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞]

‚ö†Ô∏è –í–∞–∂–Ω–æ: –≠—Ç–∏ –ø—Ä–∞–∫—Ç–∏–∫–∏ –æ—Ç–Ω–æ—Å—è—Ç—Å—è –∫ —ç–∑–æ—Ç–µ—Ä–∏–∫–µ, –∞ –Ω–µ –∫ –∫–∞–Ω–æ–Ω–∏—á–µ—Å–∫–æ–º—É –ø—Ä–∞–≤–æ—Å–ª–∞–≤–∏—é.

üìö –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏:
[–ü–æ–∫–∞–∑ –ø–µ—Ä–≤—ã—Ö 5 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤]
```

---

## üé® –í–∏–∑—É–∞–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### 1. –ù–æ–≤—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫

```html
üß† SMART RAG Agent 2025
Qwen3 Function Calling ‚Ä¢ –ó–∞—â–∏—Ç–∞ –æ—Ç –≥–∞–ª–ª—é—Ü–∏–Ω–∞—Ü–∏–π ‚Ä¢ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è
```

### 2. –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –≤ –æ—Ä–∞–Ω–∂–µ–≤—ã—Ö –±–ª–æ–∫–∞—Ö

```css
.warning-box {
    background: rgba(255, 165, 0, 0.2);
    border: 2px solid orange;
    padding: 15px;
    margin: 10px 0;
    border-radius: 10px;
}
```

### 3. –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤

```css
.source-doc {
    background: rgba(139, 0, 139, 0.1);
    border-left: 3px solid #8B008B;
    padding: 10px;
    margin: 5px 0;
    border-radius: 5px;
}
```

### 4. –ê–≤—Ç–æ–ø—Ä–æ–∫—Ä—É—Ç–∫–∞

```javascript
// –ê–≤—Ç–æ–ø—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫ –Ω–æ–≤–æ–º—É –æ—Ç–≤–µ—Ç—É
setTimeout(() => {
    const container = document.querySelector('.scroll-to-bottom');
    if (container) {
        container.scrollTop = container.scrollHeight;
    }
}, 100);
```

---

## üìà –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –î–æ | –ü–æ—Å–ª–µ |
|----------|-----|-------|
| **–¢–æ—á–Ω–æ—Å—Ç—å** | 1/10 | 9/10 ‚úÖ |
| **–ß–µ—Å—Ç–Ω–æ—Å—Ç—å** | 0/10 | 10/10 ‚úÖ |
| **–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∑–∞–ø—Ä–æ—Å—É** | 0/10 | 10/10 ‚úÖ |
| **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞** | 3/10 | 10/10 ‚úÖ |
| **–ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å** | 2/10 | 10/10 ‚úÖ |

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã:

1. **rag_smart_qwen.py** (—Å—Ç—Ä–æ–∫–∏ 397-450)
   - –ù–æ–≤—ã–π —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç —Å –∑–∞—â–∏—Ç–æ–π
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `_check_topic_relevance()`
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `_format_answer_html()`
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `_format_tools_html()`

2. **HTML/CSS** (—Å—Ç—Ä–æ–∫–∏ 647-690)
   - –ù–æ–≤—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π
   - –°—Ç–∏–ª–∏ –¥–ª—è –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
   - JavaScript –¥–ª—è –∞–≤—Ç–æ–ø—Ä–æ–∫—Ä—É—Ç–∫–∏

### –ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:

```python
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Ç–µ–º—ã
def _check_topic_relevance(query, documents) -> str

# –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞ —Å HTML
def _format_answer_html(answer, documents, tools_history) -> str

# –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞—Ö
def _format_tools_html(tools_history) -> str
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ—Å—Ç 1: –ó–∞–ø—Ä–æ—Å –Ω–µ –ø–æ —Ç–µ–º–µ –±–∞–∑—ã

**–ó–∞–ø—Ä–æ—Å:** "–∫–∞–∫ –ø—Ä–∏–≥–æ—Ç–æ–≤–∏—Ç—å –±–æ—Ä—â?"

**–û–∂–∏–¥–∞–µ—Ç—Å—è:**
```
–ò–∑–≤–∏–Ω–∏—Ç–µ, –≤ –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± —ç–∑–æ—Ç–µ—Ä–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∞–∫—Ç–∏–∫–∞—Ö
–∏ –∫–æ—Å–º–æ—ç–Ω–µ—Ä–≥–µ—Ç–∏–∫–µ. –ü–æ –∑–∞–ø—Ä–æ—Å—É "–ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏–µ –±–æ—Ä—â–∞" –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ.

–ú–æ–≥—É –ø–æ–º–æ—á—å —Å –≤–æ–ø—Ä–æ—Å–∞–º–∏ –æ –∫–æ—Å–º–æ—ç–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∏—Ö –∫–∞–Ω–∞–ª–∞—Ö –∏–ª–∏ —ç–∑–æ—Ç–µ—Ä–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∞–∫—Ç–∏–∫–∞—Ö.
```

### –¢–µ—Å—Ç 2: –ó–∞–ø—Ä–æ—Å –ø–æ —Ç–µ–º–µ, –Ω–æ —Å —Ä–µ–ª–∏–≥–∏–æ–∑–Ω—ã–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º

**–ó–∞–ø—Ä–æ—Å:** "–ø—Ä–∞–≤–æ—Å–ª–∞–≤–Ω—ã–µ –æ–±—Ä—è–¥—ã –Ω–∞ —Ä–æ–∂–¥–µ—Å—Ç–≤–æ"

**–û–∂–∏–¥–∞–µ—Ç—Å—è:**
```
‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï: –í–æ–ø—Ä–æ—Å –ø—Ä–æ —Ä–µ–ª–∏–≥–∏–æ–∑–Ω—ã–µ –ø—Ä–∞–∫—Ç–∏–∫–∏, –Ω–æ –Ω–∞–π–¥–µ–Ω—ã –≠–ó–û–¢–ï–†–ò–ß–ï–°–ö–ò–ï –º–∞—Ç–µ—Ä–∏–∞–ª—ã!

[–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∏–∑ –±–∞–∑—ã —Å —è–≤–Ω—ã–º —É–∫–∞–∑–∞–Ω–∏–µ–º —á—Ç–æ —ç—Ç–æ —ç–∑–æ—Ç–µ—Ä–∏–∫–∞]
```

### –¢–µ—Å—Ç 3: –ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –∑–∞–ø—Ä–æ—Å

**–ó–∞–ø—Ä–æ—Å:** "—Ä–∞—Å—Å–∫–∞–∂–∏ –ø—Ä–æ –∫–∞–Ω–∞–ª –§–∏—Ä–∞—Å—Ç"

**–û–∂–∏–¥–∞–µ—Ç—Å—è:**
```
[–ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –§–∏—Ä–∞—Å—Ç–µ –∏–∑ –±–∞–∑—ã]
[–ü–æ–∫–∞–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤]
```

---

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–∏:

```bash
# 1. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å—Ç–∞—Ä—ã–π –ø—Ä–æ—Ü–µ—Å—Å
taskkill /F /FI "WINDOWTITLE eq *rag_smart_qwen.py*"

# 2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –Ω–æ–≤—É—é –≤–µ—Ä—Å–∏—é
start_smart_agent.bat

# 3. –û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä
http://localhost:7861
```

### –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ:

1. **–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –æ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏** - –≤–∏–¥–Ω—ã —Å—Ä–∞–∑—É –Ω–∞–¥ –æ—Ç–≤–µ—Ç–æ–º
2. **–ò—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤** - –ø–æ–¥ –∫–∞–∂–¥—ã–º –æ—Ç–≤–µ—Ç–æ–º
3. **–î–µ—Ç–∞–ª–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤** - —Å–ø—Ä–∞–≤–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —á—Ç–æ –∏—Å–∫–∞–ª–æ—Å—å
4. **–ê–≤—Ç–æ–ø—Ä–æ–∫—Ä—É—Ç–∫–∞** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ—Ç –∫ –Ω–æ–≤–æ–º—É –æ—Ç–≤–µ—Ç—É

---

## üìù –ü—Ä–∏–º–µ—Ä—ã —Ä–∞–±–æ—Ç—ã

### –ü—Ä–∏–º–µ—Ä 1: –ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –∑–∞–ø—Ä–æ—Å –ø—Ä–æ –∫–∞–Ω–∞–ª

```
–í–æ–ø—Ä–æ—Å: —Ä–∞—Å—Å–∫–∞–∂–∏ –ø—Ä–æ –∫–∞–Ω–∞–ª –§–∏—Ä–∞—Å—Ç

–û—Ç–≤–µ—Ç:
–§–∏—Ä–∞—Å—Ç - –∫–æ—Å–º–æ—ç–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∏–π –∫–∞–Ω–∞–ª, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –¥–ª—è...
[–ø–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è]

üìö –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏:
[–ò—Å—Ç–æ—á–Ω–∏–∫ 1] –§–∏—Ä–∞—Å—Ç - –∫–∞–Ω–∞–ª –ø–µ—Ä–≤–æ–≥–æ –±–ª–æ–∫–∞...
[–ò—Å—Ç–æ—á–Ω–∏–∫ 2] –†–∞–±–æ—Ç–∞ —Å –§–∏—Ä–∞—Å—Ç–æ–º –ø—Ä–æ–≤–æ–¥–∏—Ç—Å—è...

üîß –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:
üß† 1. rag_semantic_search
   –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: query=–§–∏—Ä–∞—Å—Ç –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ, num_sources=30
   –ù–∞–π–¥–µ–Ω–æ: 15
```

### –ü—Ä–∏–º–µ—Ä 2: –ó–∞–ø—Ä–æ—Å –Ω–µ –ø–æ —Ç–µ–º–µ

```
–í–æ–ø—Ä–æ—Å: –ø—Ä–∞–≤–æ—Å–ª–∞–≤–Ω—ã–µ –æ–±—Ä—è–¥—ã –Ω–∞ —Ä–æ–∂–¥–µ—Å—Ç–≤–æ

‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï: –í–æ–ø—Ä–æ—Å –ø—Ä–æ —Ä–µ–ª–∏–≥–∏–æ–∑–Ω—ã–µ –ø—Ä–∞–∫—Ç–∏–∫–∏, –Ω–æ –Ω–∞–π–¥–µ–Ω—ã –≠–ó–û–¢–ï–†–ò–ß–ï–°–ö–ò–ï –º–∞—Ç–µ—Ä–∏–∞–ª—ã!

–í –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –≠–ó–û–¢–ï–†–ò–ß–ï–°–ö–ò–• –æ–±—Ä—è–¥–∞—Ö, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å –†–æ–∂–¥–µ—Å—Ç–≤–æ–º,
–Ω–æ —ç—Ç–æ –ù–ï –∫–∞–Ω–æ–Ω–∏—á–µ—Å–∫–∏–µ –ø—Ä–∞–≤–æ—Å–ª–∞–≤–Ω—ã–µ –ø—Ä–∞–∫—Ç–∏–∫–∏.

–ù–∞–π–¥–µ–Ω–Ω—ã–µ –≠–ó–û–¢–ï–†–ò–ß–ï–°–ö–ò–ï –æ–±—Ä—è–¥—ã:
1. –û–±—Ä—è–¥ —Å –†–æ–∂–¥–µ—Å—Ç–≤–µ–Ω—Å–∫–∏–º –≤–µ–Ω–∫–æ–º (—ç–∑–æ—Ç–µ—Ä–∏—á–µ—Å–∫–∏–π)
2. –ú–æ–ª–∏—Ç–≤–µ–Ω–Ω—ã–π —â–∏—Ç –†–æ–∂–¥–µ—Å—Ç–≤–µ–Ω—Å–∫–∏–π (—ç–∑–æ—Ç–µ—Ä–∏—á–µ—Å–∫–∏–π)

‚ö†Ô∏è –î–ª—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∫–∞–Ω–æ–Ω–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∞–≤–æ—Å–ª–∞–≤–Ω—ã—Ö –ø—Ä–∞–∫—Ç–∏–∫–∞—Ö –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ —Ü–µ—Ä–∫–æ–≤–Ω—ã–º –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º.

üìö –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏:
[–ü–æ–∫–∞–∑ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ —Å —ç–∑–æ—Ç–µ—Ä–∏—á–µ—Å–∫–∏–º–∏ –æ–±—Ä—è–¥–∞–º–∏]
```

---

## üîÆ –î–∞–ª—å–Ω–µ–π—à–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

### –ü–ª–∞–Ω—ã –Ω–∞ –±—É–¥—É—â–µ–µ:

1. **–î–æ–±–∞–≤–∏—Ç—å —Å–ª–∞–π–¥–µ—Ä "—Å—Ç—Ä–æ–≥–æ—Å—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∏"**
   - –°—Ç—Ä–æ–≥–∞—è: –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–≤–µ—Ç—ã –Ω–µ –ø–æ —Ç–µ–º–µ
   - –°—Ä–µ–¥–Ω—è—è: –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è (—Ç–µ–∫—É—â–∞—è)
   - –ú—è–≥–∫–∞—è: –æ—Ç–≤–µ—á–∞—Ç—å –Ω–æ —Å –ø–æ–º–µ—Ç–∫–∞–º–∏

2. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ –æ—Ç–≤–µ—Ç–æ–≤**
   - –°–æ—Ö—Ä–∞–Ω—è—Ç—å –º–µ—Ç—Ä–∏–∫–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è
   - –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —á–∞—Å—Ç–æ—Ç—É –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π
   - –£–ª—É—á—à–∞—Ç—å —Å–∏—Å—Ç–µ–º—É –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö

3. **–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å**
   - –ö–Ω–æ–ø–∫–∞ "–û—Ç–≤–µ—Ç –Ω–µ—Ç–æ—á–Ω—ã–π"
   - –ö–Ω–æ–ø–∫–∞ "–û—Ç–≤–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π"
   - –û–±—É—á–µ–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ñ–∏–¥–±–µ–∫–∞

4. **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞ –ø–æ–∏—Å–∫–∞**
   - –ì—Ä–∞—Ñ –≤—ã–∑–æ–≤–æ–≤ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
   - –ü–æ–∫–∞–∑ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
   - –í—Ä–µ–º–µ–Ω–Ω–∞—è —à–∫–∞–ª–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏

---

## üéì Lessons Learned

### –ß—Ç–æ –º—ã —É–∑–Ω–∞–ª–∏:

1. **–°–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–µ–Ω**
   - –ù—É–∂–Ω–æ —è–≤–Ω–æ —É–∫–∞–∑—ã–≤–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –±–∞–∑—ã
   - –ó–∞–ø—Ä–µ—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏
   - –ü—Ä–∏–º–µ—Ä—ã –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ –ø–æ–º–æ–≥–∞—é—Ç

2. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞**
   - –ù–µ–ª—å–∑—è –ø–æ–ª–∞–≥–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ –ø—Ä–æ–º–ø—Ç
   - –ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ —Ä–∞–±–æ—Ç–∞—é—Ç —Ö–æ—Ä–æ—à–æ
   - –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –ª—É—á—à–µ —á–µ–º –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞

3. **–ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å –ø–æ–≤—ã—à–∞–µ—Ç –¥–æ–≤–µ—Ä–∏–µ**
   - –ü–æ–∫–∞–∑ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–µ–Ω
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Ü–µ–Ω—è—Ç —á–µ—Å—Ç–Ω–æ—Å—Ç—å
   - –õ—É—á—à–µ —Å–∫–∞–∑–∞—Ç—å "–Ω–µ –∑–Ω–∞—é" —á–µ–º –≤—ã–¥—É–º–∞—Ç—å

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ –æ–±–Ω–∞—Ä—É–∂–∏—Ç–µ –ø—Ä–æ–±–ª–µ–º—ã –∏–ª–∏ –≥–∞–ª–ª—é—Ü–∏–Ω–∞—Ü–∏–∏:

1. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç –æ—Ç–≤–µ—Ç–∞
2. –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –ª–æ–≥–∏ (`smart_agent.log`)
3. –°–æ–∑–¥–∞–π—Ç–µ issue –Ω–∞ GitHub

---

**ü§ñ Generated with Claude Code**
Co-Authored-By: Claude <noreply@anthropic.com>

–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: 2025-10-16
